VERSION 1

NODE endpoint
SQL >
    %
    SELECT
        viewId,
        documentId,
        SUM(duration) AS sum_duration,
        COUNT(DISTINCT pageNumber) AS pages_viewed
    FROM
        page_views__v3
    WHERE
        viewId IN splitByChar(',', {{ String(viewIds, required=True) }})
    GROUP BY
        viewId, documentId
